 Ling-Qi Yan lingqi [at] berkeley [dot] edu Please visit http://www.cs.ucsb.edu/~lingqi/ . This is my old website just kept here for archival purposes. Since July 1st, 2018, I've become an Assistant Professor at the Department of Computer Science at the University of California, Santa Barbara. I received my Ph.D. degree from the Department of Electrical Engineering and Computer Sciences at the University of California, Berkeley in June 2018, advised remotely by Prof. Ravi Ramamoorthi at the University of California, San Diego. I received my bachelor degree in Computer Science from Tsinghua University in China in 2013, under the supervision of Prof. Kun Xu and Prof. Shi-Min Hu . My research interest is physically-based rendering, including appearance modeling, volumetric scattering, light transport algorithms and sampling & reconstruction theory. [ Curriculum Vitae ] Publications Rendering Specular Microgeometry with Wave Optics Ling-Qi Yan, Milo Haan , Bruce Walter , Steve Marschner , Ravi Ramamoorthi ACM Transactions on Graphics (Proceedings of SIGGRAPH 2018) Simulation of light reflection from specular surfaces is a core problem of computer graphics. Most existing solutions either make the approximation of providing only a large-area average solution in terms of a fixed BRDF (ignoring spatial detail), or are based only on geometric optics (which is an approximation to more accurate wave optics), or both. We design the first rendering algorithm based on a wave optics model, but also able to compute spatially-varying specular highlights with high-resolution detail. We compute a wave optics reflection integral over the coherence area; our solution is based on approximating the phase-delay grating representation of a micron-resolution surface heightfield using Gabor kernels. Our results show both single-wavelength and spectral solution to reflection from common everyday objects, such as brushed, scratched and bumpy metals. Paper BibTeX Video Supplementary Code (coming soon!) A BSSRDF Model for Efficient Rendering of Fur with Global Illumination Ling-Qi Yan, Weilun Sun , Henrik Wann Jensen , Ravi Ramamoorthi ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia 2017) Physically-based hair and fur rendering is crucial for visual realism. One of the key effects is global illumination, involving light bouncing between different fibers. This is very time-consuming to simulate with methods like path tracing. Efficient approximate global illumination techniques such as dual scattering are in widespread use, but are limited to human hair only, and cannot handle color bleeding, transparency and hair-object inter-reflection. We present the first global illumination model, based on dipole diffusion for subsurface scattering, to approximate light bouncing between individual fur fibers. We model complex light and fur interactions as subsurface scattering, and use a simple neural network to convert from fur fibers' properties to scattering parameters. Our network is trained on only a single scene with different parameters, but applies to general scenes and produces visually accurate appearance, supporting color bleeding and further inter-reflections. Paper BibTeX Video Supplementary Project Page (coming soon!) Multiple Axis-Aligned Filters for Rendering of Combined Distribution Effects Lifan Wu , Ling-Qi Yan, Alexandr Kuznetsov, Ravi Ramamoorthi Proceedings of the Eurographics Symposium on Rendering, 2017 Distribution effects such as diffuse global illumination, soft shadows and depth of field, are most accurately rendered using Monte Carlo ray or path tracing. However, physically accurate algorithms can take hours to converge to a noise-free image. A recent body of work has begun to bridge this gap, showing that both individual and multiple effects can be achieved accurately and efficiently. These methods use sparse sampling, GPU raytracers, and adaptive filtering for reconstruction. They are based on a Fourier analysis, which models distribution effects as a wedge in the frequency domain. The wedge can be approximated as a single large axis-aligned filter, which is fast but retains a large area outside the wedge, and therefore requires a higher sampling rate; or a tighter sheared filter, which is slow to compute. The state-of-the-art fast sheared filtering method combines low sampling rate and efficient filtering, but has been demonstrated for individual distribution effects only, and is limited by high-dimensional data storage and processing. We present a novel filter for efficient rendering of combined effects, involving soft shadows and depth of field, with global (diffuse indirect) illumination. We approximate the wedge spectrum with multiple axis-aligned filters, marrying the speed of axis-aligned filtering with an even more accurate (compact and tighter) representation than sheared filtering. We demonstrate rendering of single effects at comparable sampling and frame-rates to fast sheared filtering. Our main practical contribution is in rendering multiple distribution effects, which have not even been demonstrated accurately with sheared filtering. For this case, we present an average speedup of 6 compared with previous axis-aligned filtering methods. Paper Video An Efficient and Practical Near and Far Field Fur Reflectance Model Ling-Qi Yan, Henrik Wann Jensen , Ravi Ramamoorthi ACM Transactions on Graphics (Proceedings of SIGGRAPH 2017) Physically-based fur rendering is difficult. Recently, structural differences between hair and fur fibers have been revealed by Yan et al. [2015], who showed that fur fibers have an inner scattering medulla, and developed a double cylinder model. However, fur rendering is still complicated due to the complex scattering paths through the medulla. We develop a number of optimizations that improve efficiency and generality without compromising accuracy, leading to a practical fur reflectance model. We also propose a key contribution to support both near and far-field rendering, and allow smooth transitions between them. Specifically, we derive a compact BCSDF model for fur reflectance with only 5 lobes. Our model unifies hair and fur rendering, making it easy to implement within standard hair rendering software, since we keep the traditional R, TT, and TRT lobes in hair, and only add two extensions to scattered lobes, TT^s and TRT^s. Moreover, we introduce a compression scheme using tensor decomposition to dramatically reduce the precomputed data storage for scattered lobes to only 150 KB, with minimal loss of accuracy. By exploiting piecewise analytic integration, our method further enables a multi-scale rendering scheme that transitions between near and far field rendering smoothly and efficiently for the first time, leading to 6-8x speed up over previous work. Paper BibTeX Video Project Page (coming soon!) Antialiasing Complex Global Illumination Effects in Path-space Laurent Belcour , Ling-Qi Yan, Ravi Ramamoorthi , Derek Nowrouzezahrai ACM Transactions on Graphics, 2016 We present the first method to efficiently and accurately predict antialiasing footprints to pre-filter color-, normal-, and displacement-mapped appearance in the context of multi-bounce global illumination. We derive Fourier spectra for radiance and importance functions that allow us to compute spatial-angular filtering footprints at path vertices, for both uni- and bi-directional path construction. We then use these footprints to antialias reflectance modulated by high-resolution color, normal, and displacement maps encountered along a path. In doing so, we also unify the traditional path-space formulation of light-transport with our frequency-space interpretation of global illumination pre-filtering. Our method is fully compatible with all existing single bounce pre-filtering appearance models, not restricted by path length, and easy to implement atop existing path-space renderers. We illustrate its effectiveness on several radiometrically complex scenarios where previous approaches either completely fail or require orders of magnitude more time to arrive at similarly high-quality results. Paper BibTeX Video Position-Normal Distributions for Efficient Rendering of Specular Microstructure Ling-Qi Yan, Milo Haan , Steve Marschner , Ravi Ramamoorthi ACM Transactions on Graphics (Proceedings of SIGGRAPH 2016) Specular BRDF rendering traditionally approximates surface microstructure using a smooth normal distribution, but this ignores glinty effects, easily observable in the real world. While modeling the actual surface microstructure is possible, the resulting rendering problem is prohibitively expensive. Recently, Yan et al. [2014] and Jakob et al. [2014] made progress on this problem, but their approaches are still expensive and lack full generality in their material and illumination support. We introduce an efficient and general method that can be easily integrated in a standard rendering system. We treat a specular surface as a four-dimensional position-normal distribution, and fit this distribution using millions of 4D Gaussians, which we call elements. This leads to closed-form solutions to the required BRDF evaluation and sampling queries, enabling the first practical solution to rendering specular microstructure. Paper BibTeX Video Physically-Accurate Fur Reflectance: Modeling, Measurement and Rendering Ling-Qi Yan, Chi-Wei Tseng, Henrik Wann Jensen , Ravi Ramamoorthi ACM Transactions on Graphics (Proceedings of SIGGRAPH Asia 2015) Rendering photo-realistic animal fur is a long-standing problem in computer graphics. Considerable effort has been made on modeling the geometric complexity of fur, but the reflectance of fur fibers is not well understood. Fur has a distinct diffusive and saturated appearance, that is not captured by either the Marschner hair model or the Kajiya-Kay model. In this paper, we develop a physically-accurate reflectance model for fur fibers. Based on anatomical literature and measurements, we develop a double cylinder model for the reflectance of a single fur fiber, where an outer cylinder represents the biological observation of a cortex covered by multiple cuticle layers, and an inner cylinder represents the scattering interior structure known as the medulla. Our key contribution is to model medulla scattering accurately --- in contrast, for human hair, the medulla has minimal width and thus negligible contributions to the reflectance. Medulla scattering introduces additional reflection and transmission paths, as well as diffusive reflectance lobes. We validate our physical model with measurements on real fur fibers, and introduce the first database in computer graphics of reflectance profiles for nine fur samples. We show that our model achieves significantly better fits to the measured data than the Marschner hair reflectance model. For efficient rendering, we develop a method to precompute 2D medulla scattering profiles and analytically approximate our reflectance model with factored lobes. The accuracy of the approach is validated by comparing our rendering model to full 3D light transport simulations. Our model provides an enriched set of controls, where the parameters we fit can be directly used to render realistic fur, or serve as a starting point from which artists can manually tune parameters for desired appearances. Paper BibTeX Video Database Fast 4D Sheared Filtering for Interactive Rendering of Distribution Effects Ling-Qi Yan, Soham Uday Mehta , Ravi Ramamoorthi , Fredo Durand ACM Transactions on Graphics, 2015 Soft shadows, depth of field, and diffuse global illumination are common distribution effects, usually rendered by Monte Carlo ray tracing. Physically correct, noise-free images can require hundreds or thousands of ray samples per pixel, and take a long time to compute. Recent approaches have exploited sparse sampling and filtering; the filtering is either fast (axis-aligned), but requires more input samples, or needs fewer input samples but is very slow (sheared). We present a new approach for fast sheared filtering on the GPU. Our algorithm factors the 4D sheared filter into four 1D filters. We derive complexity bounds for our method, showing that the per-pixel complexity is reduced from O(n^2 l^2) to O(nl), where n is the linear filter width (filter size is O(n^2)) and l is the (usually very small) number of samples for each dimension of the light or lens per pixel (spp is l^2). We thus reduce sheared filtering overhead dramatically. We demonstrate rendering of depth of field, soft shadows and diffuse global illumination at interactive speeds. We reduce the number of samples needed by 5-8x, compared to axis-aligned filtering, and framerates are 4x faster for equal quality. Paper BibTeX Video Code Snippet Rendering Glints on High-Resolution Normal-Mapped Specular Surfaces Ling-Qi Yan*, Milo Haan *, Wenzel Jakob , Jason Lawrence , Steve Marschner , Ravi Ramamoorthi (*: dual first authors) ACM Transactions on Graphics (Proceedings of SIGGRAPH 2014) Rendering a complex specular surface under sharp point lighting is far from easy. Using Monte Carlo point sampling for this purpose is impractical: the energy is concentrated in tiny highlights that take up a minuscule fraction of the pixel. We instead compute the accurate solution that Monte Carlo would eventually converge to, using a completely different deterministic approach with minimal approximations. Our method considers the true distribution of normals on a surface patch seen through a single pixel, which can be highly complicated. This requires computing the probability density of the given normal coming from anywhere on the patch. We show how to evaluate this efficiently, assuming a Gaussian surface patch and Gaussian intrinsic roughness. We also take advantage of hierarchical pruning of position-normal space to quickly find texels that might contribute to a given normal distribution evaluation. Our results show complicated, temporally varying glints from materials such as bumpy plastics, brushed and scratched metals, metallic paint and ocean waves. Paper BibTeX Video Supplementary Discrete Stochastic Microfacet Models Wenzel Jakob , Milo Haan , Ling-Qi Yan, Jason Lawrence , Ravi Ramamoorthi , Steve Marschner ACM Transactions on Graphics (Proceedings of SIGGRAPH 2014) This paper investigates rendering glittery surfaces, ones which exhibit shifting random patterns of glints as the surface or viewer moves. It applies both to dramatically glittery surfaces that contain mirror-like flakes and also to rough surfaces that exhibit more subtle small scale glitter, without which most glossy surfaces appear too smooth in close-up. These phenomena can in principle be simulated by high-resolution normal maps, but maps with tiny features create severe aliasing problems under narrow-angle illumination. In this paper we present a stochastic model for the effects of random subpixel structures that generates glitter and spatial noise that behave correctly under different illumination conditions and viewing distances, while also being temporally coherent so that they look right in motion. The model is based on microfacet theory, but it replaces the usual continuous microfacet distribution with a discrete distribution of scattering particles on the surface. A novel stochastic hierarchy allows efficient evaluation in the presence of large numbers of random particles, without ever having to consider the particles individually. This leads to a multiscale procedural BRDF that is readily implemented in standard rendering systems, and which converges back to the smooth case in the limit. Paper BibTeX Video Accurate Translucent Material Rendering under Spherical Gaussian Lights Ling-Qi Yan, Yahan Zhou, Kun Xu , Rui Wang Computer Graphics Forum (Proceedings of Pacific Graphics 2012) In this paper we present a new algorithm for accurate rendering of translucent materials under Spherical Gaussian (SG) lights. Our algorithm builds upon the quantized-diffusion BSSRDF model recently introduced in [dI11]. Our main contribution is an efficient algorithm for computing the integral of the BSSRDF with an SG light. We incorporate both single and multiple scattering components. Our model improves upon previous work by accounting for the incident angle of each individual SG light. This leads to more accurate rendering results, notably elliptical profiles from oblique illumination. In contrast, most existing models only consider the total irradiance received from all lights, hence can only generate circular profiles. Experimental results show that our method is suitable for rendering of translucent materials under finite-area lights or environment lights that can be approximated by a small number of SGs. Paper BibTeX Slides 
